# CORS 跨域服务端与前端配置示例

```js
// 服务端设置：
// Node.js 示例
app.use(cors()) // 可以使用 cors 中间件
app.use((req, res, next) => {
    res.header("Access-Control-Allow-Origin", "*"); // 或指定域名
    res.header("Access-Control-Allow-Methods", "GET,POST,PUT,DELETE,OPTIONS");
    res.header("Access-Control-Allow-Headers", "Content-Type,Authorization");
    res.header("Access-Control-Allow-Credentials", "true"); // 允许携带 cookie
    
    // 预检请求直接返回 204
    if (req.method === "OPTIONS") {
        return res.sendStatus(204);
    }
    next();
});
// Access-Control-Allow-Origin: * ❌ 不能和 Access-Control-Allow-Credentials: true 同时使用

// 前端注意：
// 带凭证的请求
fetch('https://api.example.com', {
    credentials: 'include' // 需要服务端配合 Allow-Credentials
});

axios.get('http://localhost:3000/api/user', {
    withCredentials: true
});

// 功能需求	            是否支持	    设置方法
// 允许所有跨域请求	         ✅	       Access-Control-Allow-Origin: *
// 允许携带 cookie/token	✅	      需要指定具体 origin + Access-Control-Allow-Credentials: true
// 允许预检请求成功返回	     ✅	       处理 OPTIONS 请求返回 204
